(()=>{"use strict";var e=function(e){var t="00:00";if(e){var n={minimumIntegerDigits:2,useGrouping:!1},a=~~(e/3600).toLocaleString("en-US",n),r=~~(e%3600/60).toLocaleString("en-US",n),i=(~~e%60).toLocaleString("en-US",n);t=a>0?a+":"+r+":"+i:r+":"+i}return t},t=function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function s(e){try{d(a.next(e))}catch(e){i(e)}}function o(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}d((a=a.apply(e,t||[])).next())}))},n=function(e,t){var n,a,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,a=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}};!function(){function a(t){this.duration=0,this.currentTime=0,this.leftSectionID="player-left-section",this.rightSectionID="player-right-section",this.centerSectionID="player-center-section",this.shrinked=!1,this.looped=!1,this.status="stopped";var n,a=document.getElementById(t.nodeID);a?this.playerNode=a:new Error("The provided video element does not exist!"),this.width=t.width,this.height=t.height?t.height:"auto",this.listeners=(n=this,{play:function(e){e.preventDefault(),n.playerNode.play();var t=n.createPlayPauseBtn("pause");n.swapPlayPauseBtn(t),n.status="playing"},pause:function(){n.playerNode.pause();var e=n.createPlayPauseBtn("play");n.swapPlayPauseBtn(e),n.status="paused"},stop:function(){n.playerNode.pause();var e=n.createPlayPauseBtn("play");n.swapPlayPauseBtn(e),n.playerNode.currentTime=0,n.status="stopped"},seek:function(e){var t=e.target;n.playerNode.currentTime=parseInt(t.value)},toggleRepeat:function(){var e=document.getElementById("rp-btn");n.looped?(n.playerNode.loop=!1,n.looped=!1,e.classList.remove("repeated")):(n.playerNode.loop=!0,n.looped=!0,e.classList.add("repeated"))},toggleFullscreen:function(){var e=n.playerNode;e.requestFullscreen&&e.requestFullscreen()},fastForward:function(){var e=n.playerNode.currentTime;n.playerNode.currentTime=e+2},fastBack:function(){var e=n.playerNode.currentTime;n.playerNode.currentTime=e-2},onTimeUpdate:function(){var t=n.playerNode.currentTime;document.getElementById("seeker-input").value=t.toFixed().toString(),document.getElementById("current-time").textContent=e(t)}})}a.prototype.mount=function(){return t(this,void 0,void 0,(function(){var t,a=this;return n(this,(function(n){switch(n.label){case 0:return[4,this.buildComponents()];case 1:return n.sent(),this.observeSize(),t=setInterval((function(){a.playerNode.readyState>0&&(a.duration=a.playerNode.duration,document.getElementById("seeker-input").setAttribute("max",a.duration.toFixed().toString()),document.getElementById("total-duration").textContent=e(a.duration),clearInterval(t))}),200),this.playerNode.addEventListener("timeupdate",this.listeners.onTimeUpdate),this.playerNode.addEventListener("ended",(function(){a.looped||a.listeners.stop()})),[2]}}))}))},a.prototype.buildComponents=function(){return t(this,void 0,void 0,(function(){var e,t,a;return n(this,(function(n){return(e=document.createElement("div")).classList.add("bcp-wrapper"),t=this.playerNode.cloneNode(!0),e.style.width=this.width,e.style.height=this.height,e.appendChild(t),this.playerNode.replaceWith(e),this.playerNode=t,this.playerWrapper=e,a=this.buildControls(),e.appendChild(a),[2]}))}))},a.prototype.buildControls=function(){var e=document.createElement("div");e.classList.add("bcp-controls");var t=this.createSeeker();e.appendChild(t);var n=this.createVideoCtrlBox();return e.appendChild(n),e},a.prototype.createSeeker=function(){var e=document.createElement("div");e.classList.add("seeker-container");var t=document.createElement("input");return t.classList.add("seeker-slider"),t.id="seeker-input",t.setAttribute("type","range"),t.setAttribute("min","0"),t.value="0",t.addEventListener("input",this.listeners.seek),e.appendChild(t),e},a.prototype.createVideoCtrlBox=function(){var e=document.createElement("div");e.classList.add("control-buttons-container");var t=this.createVolumeCtrl(),n=this.createPlaybackCtrl(),a=this.createOtherButtons();return e.appendChild(t),e.appendChild(n),e.appendChild(a),e},a.prototype.createVolumeCtrl=function(){var e=document.createElement("div");e.classList.add("cbc-left-section"),e.id=this.leftSectionID;var t=document.createElement("div");t.classList.add("speaker-icon","player-icon");var n=document.createElement("i");n.classList.add("fa-solid","fa-volume-high"),t.appendChild(n);var a=document.createElement("input");return a.setAttribute("type","range"),a.classList.add("volume-ctrl-slider"),e.appendChild(t),e.appendChild(a),e},a.prototype.createPlaybackCtrl=function(){var e=document.createElement("div");e.classList.add("cbc-center-section"),e.id=this.centerSectionID;var t=document.createElement("p");t.classList.add("time-display"),t.id="current-time",t.textContent="00:00";var n=this.createIcon();n.classList.add("fa","fa-backward","player-icon");var a=this.createBtn();a.classList.add("fb-btn"),a.appendChild(n),a.addEventListener("click",this.listeners.fastBack);var r=this.createPlayPauseBtn("play"),i=this.createIcon();i.classList.add("fa","fa-forward","player-icon");var s=this.createBtn();s.classList.add("ff-btn"),s.appendChild(i),s.addEventListener("click",this.listeners.fastForward);var o=t.cloneNode(!0);return o.id="total-duration",e.appendChild(t),e.appendChild(a),e.appendChild(r),e.appendChild(s),e.appendChild(o),e},a.prototype.createOtherButtons=function(){var e=document.createElement("div");e.classList.add("cbc-right-section"),e.id=this.rightSectionID;var t=this.createBtn();t.classList.add("stop-btn");var n=this.createIcon();n.classList.add("fa-solid","fa-stop","player-icon"),t.appendChild(n),t.addEventListener("click",this.listeners.stop);var a=this.createBtn();a.classList.add("rp-btn"),a.id="rp-btn";var r=this.createIcon();r.classList.add("fa-solid","fa-repeat"),a.appendChild(r),a.addEventListener("click",this.listeners.toggleRepeat);var i=this.createBtn();i.classList.add("fs-btn");var s=this.createIcon();return s.classList.add("fa-solid","fa-expand","player-icon"),i.appendChild(s),i.addEventListener("click",this.listeners.toggleFullscreen),e.appendChild(t),e.appendChild(a),e.appendChild(i),e},a.prototype.createBtn=function(){var e=document.createElement("div");return e.classList.add("pb-btn"),e},a.prototype.createIcon=function(){return document.createElement("i")},a.prototype.createPlayPauseBtn=function(e){var t=this.createIcon();t.classList.add("fa-solid","fa-".concat(e),"player-icon");var n=this.createBtn();n.id="play-pause-btn",n.classList.add("".concat(e,"-btn")),n.appendChild(t);var a="play"===e?this.listeners.play:this.listeners.pause;return n.addEventListener("click",a),n},a.prototype.swapPlayPauseBtn=function(e){document.getElementById("play-pause-btn").replaceWith(e)},a.prototype.observeSize=function(){var e=this;new ResizeObserver((function(t){var n=document.getElementById(e.leftSectionID),a=document.getElementById(e.rightSectionID),r=document.getElementById(e.centerSectionID);t[0].contentRect.width<520?(e.hide(n),e.hide(a),r.style.width="100%",e.shrinked=!0):e.shrinked&&(r.style.width="50%",e.show(n),e.show(a))})).observe(this.playerWrapper)},a.prototype.hide=function(e){e.classList.add("hide")},a.prototype.show=function(e){e.classList.remove("hide")}}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R2IyQyxFQUFNM0MsV0FDTitFLEVBQWN0QixNQUFNL0MsTUFBUSxNQUM1QmlDLEVBQU00RCxLQUFLNUIsR0FDWGhDLEVBQU00RCxLQUFLaEIsT0FJZGlCLFFBQVF4SCxLQUFLb0UsZ0JBRTFCM0QsRUFBZStDLFVBQVU4RCxLQUFPLFNBQVVsRyxHQUN0Q0EsRUFBS3VCLFVBQVVFLElBQUksU0FFdkJwQyxFQUFlK0MsVUFBVStELEtBQU8sU0FBVW5HLEdBQ3RDQSxFQUFLdUIsVUFBVUMsT0FBTyxTQXBSSyxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2xhcmVuY2UtanMvLi9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vY2xhcmVuY2UtanMvLi9zcmMvY2xhcmVuY2UudHMiLCJ3ZWJwYWNrOi8vY2xhcmVuY2UtanMvLi9zcmMvbGlzdGVuZXJzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDb252ZXJ0cyBzZWNvbmRzIGluIHRpbWUgdG8gcmVhZGFibGUgaHI6bWluOnNlY1xyXG4gKiBAcGFyYW0ge251bWJlcn0gc2VjIC0gVGhlIHRpbWUgaW4gc2Vjb25kc1xyXG4gKi9cclxuZXhwb3J0IHZhciBnZXREaXNwbGF5VGltZSA9IGZ1bmN0aW9uIChzZWMpIHtcclxuICAgIHZhciBmVGltZSA9IFwiMDA6MDBcIjtcclxuICAgIGlmIChzZWMpIHtcclxuICAgICAgICB2YXIgY29uZmlnID0ge1xyXG4gICAgICAgICAgICBtaW5pbXVtSW50ZWdlckRpZ2l0czogMixcclxuICAgICAgICAgICAgdXNlR3JvdXBpbmc6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgaHJzID0gfn4oc2VjIC8gMzYwMCkudG9Mb2NhbGVTdHJpbmcoXCJlbi1VU1wiLCBjb25maWcpO1xyXG4gICAgICAgIHZhciBtaW5zID0gfn4oKHNlYyAlIDM2MDApIC8gNjApLnRvTG9jYWxlU3RyaW5nKFwiZW4tVVNcIiwgY29uZmlnKTtcclxuICAgICAgICB2YXIgc2VjcyA9ICh+fnNlYyAlIDYwKS50b0xvY2FsZVN0cmluZyhcImVuLVVTXCIsIGNvbmZpZyk7XHJcbiAgICAgICAgaWYgKGhycyA+IDApXHJcbiAgICAgICAgICAgIGZUaW1lID0gaHJzICsgXCI6XCIgKyBtaW5zICsgJzonICsgc2VjcztcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIGZUaW1lID0gbWlucyArICc6JyArIHNlY3M7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZlRpbWU7XHJcbn07XHJcbiIsInZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59O1xyXG5pbXBvcnQgeyBldmVudExpc3RlbmVycyB9IGZyb20gJy4vbGlzdGVuZXJzJztcclxuaW1wb3J0IHsgZ2V0RGlzcGxheVRpbWUgfSBmcm9tICcuL3V0aWxzJztcclxudmFyIENsYXJlbmNlUGxheWVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ2xhcmVuY2VQbGF5ZXIob3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMuZHVyYXRpb24gPSAwO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFRpbWUgPSAwO1xyXG4gICAgICAgIHRoaXMubGVmdFNlY3Rpb25JRCA9ICdwbGF5ZXItbGVmdC1zZWN0aW9uJztcclxuICAgICAgICB0aGlzLnJpZ2h0U2VjdGlvbklEID0gJ3BsYXllci1yaWdodC1zZWN0aW9uJztcclxuICAgICAgICB0aGlzLmNlbnRlclNlY3Rpb25JRCA9ICdwbGF5ZXItY2VudGVyLXNlY3Rpb24nO1xyXG4gICAgICAgIHRoaXMuc2hyaW5rZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmxvb3BlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc3RhdHVzID0gJ3N0b3BwZWQnO1xyXG4gICAgICAgIHZhciBub2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3B0aW9ucy5ub2RlSUQpO1xyXG4gICAgICAgIGlmIChub2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyTm9kZSA9IG5vZGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBuZXcgRXJyb3IoXCJUaGUgcHJvdmlkZWQgdmlkZW8gZWxlbWVudCBkb2VzIG5vdCBleGlzdCFcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMud2lkdGggPSBvcHRpb25zLndpZHRoO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQgPyBvcHRpb25zLmhlaWdodCA6ICdhdXRvJztcclxuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IGV2ZW50TGlzdGVuZXJzKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBNb3VudHMgdGhlIHZpZGVvIHBsYXllclxyXG4gICAgICovXHJcbiAgICBDbGFyZW5jZVBsYXllci5wcm90b3R5cGUubW91bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2V0dGVyO1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmJ1aWxkQ29tcG9uZW50cygpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vYnNlcnZlU2l6ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXR0ZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVhZHkgPSBfdGhpcy5wbGF5ZXJOb2RlLnJlYWR5U3RhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVhZHkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZHVyYXRpb24gPSBfdGhpcy5wbGF5ZXJOb2RlLmR1cmF0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWVrZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Vla2VyLWlucHV0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vla2VyLnNldEF0dHJpYnV0ZSgnbWF4JywgX3RoaXMuZHVyYXRpb24udG9GaXhlZCgpLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aW1lRGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3RhbC1kdXJhdGlvbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVEaXNwbGF5LnRleHRDb250ZW50ID0gZ2V0RGlzcGxheVRpbWUoX3RoaXMuZHVyYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoc2V0dGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMjAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJOb2RlLmFkZEV2ZW50TGlzdGVuZXIoJ3RpbWV1cGRhdGUnLCB0aGlzLmxpc3RlbmVycy5vblRpbWVVcGRhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllck5vZGUuYWRkRXZlbnRMaXN0ZW5lcignZW5kZWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIV90aGlzLmxvb3BlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmxpc3RlbmVycy5zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQnVpbGQgcGxheWVyJ3MgY29tcG9uZW50cyBpbmNsdWRpbmcgdmlkZW8gd3JhcHBlciBhbmQgY29udHJvbHMuXHJcbiAgICAgKi9cclxuICAgIENsYXJlbmNlUGxheWVyLnByb3RvdHlwZS5idWlsZENvbXBvbmVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcGxheWVyV3JhcHBlciwgcGxheWVyTm9kZUNsb25lLCBjb250cm9scztcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICAgICAgcGxheWVyV3JhcHBlci5jbGFzc0xpc3QuYWRkKCdiY3Atd3JhcHBlcicpO1xyXG4gICAgICAgICAgICAgICAgcGxheWVyTm9kZUNsb25lID0gdGhpcy5wbGF5ZXJOb2RlLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgIHBsYXllcldyYXBwZXIuc3R5bGUud2lkdGggPSB0aGlzLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgcGxheWVyV3JhcHBlci5zdHlsZS5oZWlnaHQgPSB0aGlzLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIC8vIHBsYXllcldyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IGUucHJldmVudERlZmF1bHQoKSlcclxuICAgICAgICAgICAgICAgIHBsYXllcldyYXBwZXIuYXBwZW5kQ2hpbGQocGxheWVyTm9kZUNsb25lKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyTm9kZS5yZXBsYWNlV2l0aChwbGF5ZXJXcmFwcGVyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyTm9kZSA9IHBsYXllck5vZGVDbG9uZTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyV3JhcHBlciA9IHBsYXllcldyYXBwZXI7XHJcbiAgICAgICAgICAgICAgICBjb250cm9scyA9IHRoaXMuYnVpbGRDb250cm9scygpO1xyXG4gICAgICAgICAgICAgICAgcGxheWVyV3JhcHBlci5hcHBlbmRDaGlsZChjb250cm9scyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIENsYXJlbmNlUGxheWVyLnByb3RvdHlwZS5idWlsZENvbnRyb2xzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjb250cm9scyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIGNvbnRyb2xzLmNsYXNzTGlzdC5hZGQoJ2JjcC1jb250cm9scycpO1xyXG4gICAgICAgIC8vIGFkZCBzZWVrZXJcclxuICAgICAgICB2YXIgc2Vla2VyID0gdGhpcy5jcmVhdGVTZWVrZXIoKTtcclxuICAgICAgICBjb250cm9scy5hcHBlbmRDaGlsZChzZWVrZXIpO1xyXG4gICAgICAgIC8vIGNvbnRyb2wgYm94XHJcbiAgICAgICAgdmFyIGN0cmxCb3ggPSB0aGlzLmNyZWF0ZVZpZGVvQ3RybEJveCgpO1xyXG4gICAgICAgIGNvbnRyb2xzLmFwcGVuZENoaWxkKGN0cmxCb3gpO1xyXG4gICAgICAgIHJldHVybiBjb250cm9scztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgdGhlIHZpZGVvIHNlZWtlciBVSS5cclxuICAgICAqIEByZXR1cm5zXHJcbiAgICAgKi9cclxuICAgIENsYXJlbmNlUGxheWVyLnByb3RvdHlwZS5jcmVhdGVTZWVrZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNlZWtlckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHNlZWtlckRpdi5jbGFzc0xpc3QuYWRkKCdzZWVrZXItY29udGFpbmVyJyk7XHJcbiAgICAgICAgdmFyIHNlZWtlcklucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICAgICAgICBzZWVrZXJJbnB1dC5jbGFzc0xpc3QuYWRkKCdzZWVrZXItc2xpZGVyJyk7XHJcbiAgICAgICAgc2Vla2VySW5wdXQuaWQgPSAnc2Vla2VyLWlucHV0JztcclxuICAgICAgICBzZWVrZXJJbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAncmFuZ2UnKTtcclxuICAgICAgICBzZWVrZXJJbnB1dC5zZXRBdHRyaWJ1dGUoJ21pbicsICcwJyk7XHJcbiAgICAgICAgc2Vla2VySW5wdXQudmFsdWUgPSAnMCc7XHJcbiAgICAgICAgc2Vla2VySW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmxpc3RlbmVycy5zZWVrKTtcclxuICAgICAgICBzZWVrZXJEaXYuYXBwZW5kQ2hpbGQoc2Vla2VySW5wdXQpO1xyXG4gICAgICAgIHJldHVybiBzZWVrZXJEaXY7XHJcbiAgICB9O1xyXG4gICAgQ2xhcmVuY2VQbGF5ZXIucHJvdG90eXBlLmNyZWF0ZVZpZGVvQ3RybEJveCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdmlkZW9DdHJsQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgdmlkZW9DdHJsQm94LmNsYXNzTGlzdC5hZGQoJ2NvbnRyb2wtYnV0dG9ucy1jb250YWluZXInKTtcclxuICAgICAgICAvLyBjcmVhdCB2b2x1bWUgY29udHJvbCBhdCBsZWZ0XHJcbiAgICAgICAgdmFyIHZvbHVtZUN0cmwgPSB0aGlzLmNyZWF0ZVZvbHVtZUN0cmwoKTtcclxuICAgICAgICAvLyBwbGF5YmFjayBjb250cm9sIGF0IHJpZ2h0XHJcbiAgICAgICAgdmFyIHBiQ29udHJvbCA9IHRoaXMuY3JlYXRlUGxheWJhY2tDdHJsKCk7XHJcbiAgICAgICAgLy8gb3RoZXIgY29udHJvbHNcclxuICAgICAgICB2YXIgb3RoZXJDdHJsID0gdGhpcy5jcmVhdGVPdGhlckJ1dHRvbnMoKTtcclxuICAgICAgICB2aWRlb0N0cmxCb3guYXBwZW5kQ2hpbGQodm9sdW1lQ3RybCk7XHJcbiAgICAgICAgdmlkZW9DdHJsQm94LmFwcGVuZENoaWxkKHBiQ29udHJvbCk7XHJcbiAgICAgICAgdmlkZW9DdHJsQm94LmFwcGVuZENoaWxkKG90aGVyQ3RybCk7XHJcbiAgICAgICAgcmV0dXJuIHZpZGVvQ3RybEJveDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIHZvbHVtZSBjb250cm9sIHVpXHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICBDbGFyZW5jZVBsYXllci5wcm90b3R5cGUuY3JlYXRlVm9sdW1lQ3RybCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBsZWZ0IHNlY3Rpb24gb2YgdGhlIGJveFxyXG4gICAgICAgIHZhciBsZWZ0U2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIGxlZnRTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2NiYy1sZWZ0LXNlY3Rpb24nKTtcclxuICAgICAgICBsZWZ0U2VjdGlvbi5pZCA9IHRoaXMubGVmdFNlY3Rpb25JRDtcclxuICAgICAgICAvLyB2b2x1bWUgY3RybCBjb250YWluZXJcclxuICAgICAgICB2YXIgc3BlYWtlckljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBzcGVha2VySWNvbi5jbGFzc0xpc3QuYWRkKCdzcGVha2VyLWljb24nLCAncGxheWVyLWljb24nKTtcclxuICAgICAgICAvLyB2b2x1bWUgaWNvblxyXG4gICAgICAgIHZhciB2SWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcclxuICAgICAgICB2SWNvbi5jbGFzc0xpc3QuYWRkKCdmYS1zb2xpZCcsICdmYS12b2x1bWUtaGlnaCcpO1xyXG4gICAgICAgIHNwZWFrZXJJY29uLmFwcGVuZENoaWxkKHZJY29uKTtcclxuICAgICAgICAvLyB2b2x1bWUgc2xpZGVyXHJcbiAgICAgICAgdmFyIHZTbGlkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgICAgIHZTbGlkZXIuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3JhbmdlJyk7XHJcbiAgICAgICAgdlNsaWRlci5jbGFzc0xpc3QuYWRkKCd2b2x1bWUtY3RybC1zbGlkZXInKTtcclxuICAgICAgICBsZWZ0U2VjdGlvbi5hcHBlbmRDaGlsZChzcGVha2VySWNvbik7XHJcbiAgICAgICAgbGVmdFNlY3Rpb24uYXBwZW5kQ2hpbGQodlNsaWRlcik7XHJcbiAgICAgICAgcmV0dXJuIGxlZnRTZWN0aW9uO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBwbGF5YmFjayBjb250cm9sIGJ1dHRvbnMgYXQgdGhlIGNlbnRlciBzZWN0aW9uXHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICBDbGFyZW5jZVBsYXllci5wcm90b3R5cGUuY3JlYXRlUGxheWJhY2tDdHJsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjZW50ZXJTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgY2VudGVyU2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdjYmMtY2VudGVyLXNlY3Rpb24nKTtcclxuICAgICAgICBjZW50ZXJTZWN0aW9uLmlkID0gdGhpcy5jZW50ZXJTZWN0aW9uSUQ7XHJcbiAgICAgICAgLy8gY3VycmVudCB0aW1lXHJcbiAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgICAgIGN1cnJlbnRUaW1lLmNsYXNzTGlzdC5hZGQoJ3RpbWUtZGlzcGxheScpO1xyXG4gICAgICAgIGN1cnJlbnRUaW1lLmlkID0gJ2N1cnJlbnQtdGltZSc7XHJcbiAgICAgICAgY3VycmVudFRpbWUudGV4dENvbnRlbnQgPSAnMDA6MDAnO1xyXG4gICAgICAgIC8vIGZhc3RCYWNrIGljb24gYW5kIGJ1dHRvblxyXG4gICAgICAgIHZhciBmYkljb24gPSB0aGlzLmNyZWF0ZUljb24oKTtcclxuICAgICAgICBmYkljb24uY2xhc3NMaXN0LmFkZCgnZmEnLCAnZmEtYmFja3dhcmQnLCAncGxheWVyLWljb24nKTtcclxuICAgICAgICB2YXIgZmJCdG4gPSB0aGlzLmNyZWF0ZUJ0bigpO1xyXG4gICAgICAgIGZiQnRuLmNsYXNzTGlzdC5hZGQoJ2ZiLWJ0bicpO1xyXG4gICAgICAgIGZiQnRuLmFwcGVuZENoaWxkKGZiSWNvbik7XHJcbiAgICAgICAgZmJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmxpc3RlbmVycy5mYXN0QmFjayk7XHJcbiAgICAgICAgLy8gcGxheSBpY29uIGFuZCBidXR0b25cclxuICAgICAgICB2YXIgcGxheUJ0biA9IHRoaXMuY3JlYXRlUGxheVBhdXNlQnRuKCdwbGF5Jyk7XHJcbiAgICAgICAgLy8gdGhpcy5idG5zLnBsYXkgPSBwbGF5QnRuXHJcbiAgICAgICAgLy8gZmFzdEJhY2sgaWNvbiBhbmQgYnV0dG9uXHJcbiAgICAgICAgdmFyIGZmSWNvbiA9IHRoaXMuY3JlYXRlSWNvbigpO1xyXG4gICAgICAgIGZmSWNvbi5jbGFzc0xpc3QuYWRkKCdmYScsICdmYS1mb3J3YXJkJywgJ3BsYXllci1pY29uJyk7XHJcbiAgICAgICAgdmFyIGZmQnRuID0gdGhpcy5jcmVhdGVCdG4oKTtcclxuICAgICAgICBmZkJ0bi5jbGFzc0xpc3QuYWRkKCdmZi1idG4nKTtcclxuICAgICAgICBmZkJ0bi5hcHBlbmRDaGlsZChmZkljb24pO1xyXG4gICAgICAgIGZmQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5saXN0ZW5lcnMuZmFzdEZvcndhcmQpO1xyXG4gICAgICAgIC8vIHRvdGFsIGR1cmF0aW9uXHJcbiAgICAgICAgdmFyIHRvdGFsVGltZSA9IGN1cnJlbnRUaW1lLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICB0b3RhbFRpbWUuaWQgPSAndG90YWwtZHVyYXRpb24nO1xyXG4gICAgICAgIGNlbnRlclNlY3Rpb24uYXBwZW5kQ2hpbGQoY3VycmVudFRpbWUpO1xyXG4gICAgICAgIGNlbnRlclNlY3Rpb24uYXBwZW5kQ2hpbGQoZmJCdG4pO1xyXG4gICAgICAgIGNlbnRlclNlY3Rpb24uYXBwZW5kQ2hpbGQocGxheUJ0bik7XHJcbiAgICAgICAgY2VudGVyU2VjdGlvbi5hcHBlbmRDaGlsZChmZkJ0bik7XHJcbiAgICAgICAgY2VudGVyU2VjdGlvbi5hcHBlbmRDaGlsZCh0b3RhbFRpbWUpO1xyXG4gICAgICAgIHJldHVybiBjZW50ZXJTZWN0aW9uO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogY3JlYXRlIG90aGVyIGJ1dHRvbnMgYXQgdGhlIGxlZnQgc2VjdGlvblxyXG4gICAgICogQHJldHVybnNcclxuICAgICAqL1xyXG4gICAgQ2xhcmVuY2VQbGF5ZXIucHJvdG90eXBlLmNyZWF0ZU90aGVyQnV0dG9ucyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcmlnaHRTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgcmlnaHRTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2NiYy1yaWdodC1zZWN0aW9uJyk7XHJcbiAgICAgICAgcmlnaHRTZWN0aW9uLmlkID0gdGhpcy5yaWdodFNlY3Rpb25JRDtcclxuICAgICAgICAvLyBzdG9wIGJ1dHRvblxyXG4gICAgICAgIHZhciBzdG9wQnRuID0gdGhpcy5jcmVhdGVCdG4oKTtcclxuICAgICAgICBzdG9wQnRuLmNsYXNzTGlzdC5hZGQoJ3N0b3AtYnRuJyk7XHJcbiAgICAgICAgdmFyIHN0b3BJY29uID0gdGhpcy5jcmVhdGVJY29uKCk7XHJcbiAgICAgICAgc3RvcEljb24uY2xhc3NMaXN0LmFkZCgnZmEtc29saWQnLCAnZmEtc3RvcCcsICdwbGF5ZXItaWNvbicpO1xyXG4gICAgICAgIHN0b3BCdG4uYXBwZW5kQ2hpbGQoc3RvcEljb24pO1xyXG4gICAgICAgIHN0b3BCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmxpc3RlbmVycy5zdG9wKTtcclxuICAgICAgICAvLyByZXBlYXQgYnV0dG9uXHJcbiAgICAgICAgdmFyIHJwQnRuID0gdGhpcy5jcmVhdGVCdG4oKTtcclxuICAgICAgICBycEJ0bi5jbGFzc0xpc3QuYWRkKCdycC1idG4nKTtcclxuICAgICAgICBycEJ0bi5pZCA9ICdycC1idG4nO1xyXG4gICAgICAgIHZhciBycEljb24gPSB0aGlzLmNyZWF0ZUljb24oKTtcclxuICAgICAgICBycEljb24uY2xhc3NMaXN0LmFkZCgnZmEtc29saWQnLCAnZmEtcmVwZWF0Jyk7XHJcbiAgICAgICAgcnBCdG4uYXBwZW5kQ2hpbGQocnBJY29uKTtcclxuICAgICAgICBycEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMubGlzdGVuZXJzLnRvZ2dsZVJlcGVhdCk7XHJcbiAgICAgICAgLy8gZnVsbHNjcmVlbiBidXR0b25cclxuICAgICAgICB2YXIgZnNCdG4gPSB0aGlzLmNyZWF0ZUJ0bigpO1xyXG4gICAgICAgIGZzQnRuLmNsYXNzTGlzdC5hZGQoJ2ZzLWJ0bicpO1xyXG4gICAgICAgIHZhciBmc0ljb24gPSB0aGlzLmNyZWF0ZUljb24oKTtcclxuICAgICAgICBmc0ljb24uY2xhc3NMaXN0LmFkZCgnZmEtc29saWQnLCAnZmEtZXhwYW5kJywgJ3BsYXllci1pY29uJyk7XHJcbiAgICAgICAgZnNCdG4uYXBwZW5kQ2hpbGQoZnNJY29uKTtcclxuICAgICAgICBmc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMubGlzdGVuZXJzLnRvZ2dsZUZ1bGxzY3JlZW4pO1xyXG4gICAgICAgIHJpZ2h0U2VjdGlvbi5hcHBlbmRDaGlsZChzdG9wQnRuKTtcclxuICAgICAgICByaWdodFNlY3Rpb24uYXBwZW5kQ2hpbGQocnBCdG4pO1xyXG4gICAgICAgIHJpZ2h0U2VjdGlvbi5hcHBlbmRDaGlsZChmc0J0bik7XHJcbiAgICAgICAgcmV0dXJuIHJpZ2h0U2VjdGlvbjtcclxuICAgIH07XHJcbiAgICBDbGFyZW5jZVBsYXllci5wcm90b3R5cGUuY3JlYXRlQnRuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBidG5EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBidG5EaXYuY2xhc3NMaXN0LmFkZCgncGItYnRuJyk7XHJcbiAgICAgICAgcmV0dXJuIGJ0bkRpdjtcclxuICAgIH07XHJcbiAgICBDbGFyZW5jZVBsYXllci5wcm90b3R5cGUuY3JlYXRlSWNvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcclxuICAgICAgICByZXR1cm4gaWNvbjtcclxuICAgIH07XHJcbiAgICBDbGFyZW5jZVBsYXllci5wcm90b3R5cGUuY3JlYXRlUGxheVBhdXNlQnRuID0gZnVuY3Rpb24gKGJ1dHRvblR5cGUpIHtcclxuICAgICAgICB2YXIgcGxheUljb24gPSB0aGlzLmNyZWF0ZUljb24oKTtcclxuICAgICAgICBwbGF5SWNvbi5jbGFzc0xpc3QuYWRkKCdmYS1zb2xpZCcsIFwiZmEtXCIuY29uY2F0KGJ1dHRvblR5cGUpLCAncGxheWVyLWljb24nKTtcclxuICAgICAgICB2YXIgcGxheUJ0biA9IHRoaXMuY3JlYXRlQnRuKCk7XHJcbiAgICAgICAgcGxheUJ0bi5pZCA9ICdwbGF5LXBhdXNlLWJ0bic7XHJcbiAgICAgICAgcGxheUJ0bi5jbGFzc0xpc3QuYWRkKFwiXCIuY29uY2F0KGJ1dHRvblR5cGUsIFwiLWJ0blwiKSk7XHJcbiAgICAgICAgcGxheUJ0bi5hcHBlbmRDaGlsZChwbGF5SWNvbik7XHJcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gYnV0dG9uVHlwZSA9PT0gJ3BsYXknID8gdGhpcy5saXN0ZW5lcnMucGxheSA6IHRoaXMubGlzdGVuZXJzLnBhdXNlO1xyXG4gICAgICAgIHBsYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsaXN0ZW5lcik7XHJcbiAgICAgICAgcmV0dXJuIHBsYXlCdG47XHJcbiAgICB9O1xyXG4gICAgQ2xhcmVuY2VQbGF5ZXIucHJvdG90eXBlLnN3YXBQbGF5UGF1c2VCdG4gPSBmdW5jdGlvbiAobmV3QnV0dG9uKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheS1wYXVzZS1idG4nKTtcclxuICAgICAgICBjdXJyZW50QnRuLnJlcGxhY2VXaXRoKG5ld0J1dHRvbik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBPYnNlcnZlciBwbGF5ZXIgd3JhcHBlcidzIHNpemUuXHJcbiAgICAgKlxyXG4gICAgICogSWYgdGhlIHNpemUgaXMgdG9vIHNtYWxsIChiZWxvdyA1MjBweCksIGhpZGVzIGxlZnQgYW5kIHJpZ2h0IHNlY3Rpb24gYW5kIHJlc2l6ZSBtaWRkbGUgc2VjdGlvbiBvZiB0aGUgY29udHJvbGxlclxyXG4gICAgICovXHJcbiAgICBDbGFyZW5jZVBsYXllci5wcm90b3R5cGUub2JzZXJ2ZVNpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoZnVuY3Rpb24gKGVudHJpZXMpIHtcclxuICAgICAgICAgICAgdmFyIGxlZnRTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoX3RoaXMubGVmdFNlY3Rpb25JRCk7XHJcbiAgICAgICAgICAgIHZhciByaWdodFNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChfdGhpcy5yaWdodFNlY3Rpb25JRCk7XHJcbiAgICAgICAgICAgIHZhciBjZW50ZXJTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoX3RoaXMuY2VudGVyU2VjdGlvbklEKTtcclxuICAgICAgICAgICAgdmFyIHdpZHRoID0gZW50cmllc1swXS5jb250ZW50UmVjdC53aWR0aDtcclxuICAgICAgICAgICAgaWYgKHdpZHRoIDwgNTIwKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5oaWRlKGxlZnRTZWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmhpZGUocmlnaHRTZWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIGNlbnRlclNlY3Rpb24uc3R5bGUud2lkdGggPSAnMTAwJSc7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zaHJpbmtlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc2hyaW5rZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjZW50ZXJTZWN0aW9uLnN0eWxlLndpZHRoID0gJzUwJSc7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2hvdyhsZWZ0U2VjdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2hvdyhyaWdodFNlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLnBsYXllcldyYXBwZXIpO1xyXG4gICAgfTtcclxuICAgIENsYXJlbmNlUGxheWVyLnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcclxuICAgIH07XHJcbiAgICBDbGFyZW5jZVBsYXllci5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENsYXJlbmNlUGxheWVyO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBDbGFyZW5jZVBsYXllcjtcclxuIiwiaW1wb3J0IHsgZ2V0RGlzcGxheVRpbWUgfSBmcm9tICcuL3V0aWxzJztcclxuZXhwb3J0IHZhciBldmVudExpc3RlbmVycyA9IGZ1bmN0aW9uICh2aWRlb1BsYXllcikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBwbGF5OiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHZpZGVvUGxheWVyLnBsYXllck5vZGUucGxheSgpO1xyXG4gICAgICAgICAgICB2YXIgcGF1c2VCdG4gPSB2aWRlb1BsYXllci5jcmVhdGVQbGF5UGF1c2VCdG4oJ3BhdXNlJyk7XHJcbiAgICAgICAgICAgIHZpZGVvUGxheWVyLnN3YXBQbGF5UGF1c2VCdG4ocGF1c2VCdG4pO1xyXG4gICAgICAgICAgICB2aWRlb1BsYXllci5zdGF0dXMgPSAncGxheWluZyc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwYXVzZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2aWRlb1BsYXllci5wbGF5ZXJOb2RlLnBhdXNlKCk7XHJcbiAgICAgICAgICAgIHZhciBwbGF5QnRuID0gdmlkZW9QbGF5ZXIuY3JlYXRlUGxheVBhdXNlQnRuKCdwbGF5Jyk7XHJcbiAgICAgICAgICAgIHZpZGVvUGxheWVyLnN3YXBQbGF5UGF1c2VCdG4ocGxheUJ0bik7XHJcbiAgICAgICAgICAgIHZpZGVvUGxheWVyLnN0YXR1cyA9ICdwYXVzZWQnO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RvcDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2aWRlb1BsYXllci5wbGF5ZXJOb2RlLnBhdXNlKCk7XHJcbiAgICAgICAgICAgIHZhciBwbGF5QnRuID0gdmlkZW9QbGF5ZXIuY3JlYXRlUGxheVBhdXNlQnRuKCdwbGF5Jyk7XHJcbiAgICAgICAgICAgIHZpZGVvUGxheWVyLnN3YXBQbGF5UGF1c2VCdG4ocGxheUJ0bik7XHJcbiAgICAgICAgICAgIHZpZGVvUGxheWVyLnBsYXllck5vZGUuY3VycmVudFRpbWUgPSAwO1xyXG4gICAgICAgICAgICB2aWRlb1BsYXllci5zdGF0dXMgPSAnc3RvcHBlZCc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZWVrOiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XHJcbiAgICAgICAgICAgIHZpZGVvUGxheWVyLnBsYXllck5vZGUuY3VycmVudFRpbWUgPSBwYXJzZUludCh0YXJnZXQudmFsdWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9nZ2xlUmVwZWF0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBycEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdycC1idG4nKTtcclxuICAgICAgICAgICAgaWYgKCF2aWRlb1BsYXllci5sb29wZWQpIHtcclxuICAgICAgICAgICAgICAgIHZpZGVvUGxheWVyLnBsYXllck5vZGUubG9vcCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB2aWRlb1BsYXllci5sb29wZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcnBCdG4uY2xhc3NMaXN0LmFkZCgncmVwZWF0ZWQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZpZGVvUGxheWVyLnBsYXllck5vZGUubG9vcCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdmlkZW9QbGF5ZXIubG9vcGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBycEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdyZXBlYXRlZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b2dnbGVGdWxsc2NyZWVuOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGVtID0gdmlkZW9QbGF5ZXIucGxheWVyTm9kZTtcclxuICAgICAgICAgICAgLy8gY29uc3QgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdqaCcpXHJcbiAgICAgICAgICAgIGlmIChlbGVtLnJlcXVlc3RGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtLnJlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gZWxzZSBpZiAoZWxlbS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbikgeyAvKiBTYWZhcmkgKi9cclxuICAgICAgICAgICAgLy8gICAgIGVsZW0ud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICAgICAgLy8gfSBlbHNlIGlmIChlbGVtLm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHsgLyogSUUxMSAqL1xyXG4gICAgICAgICAgICAvLyAgICAgZWxlbS5tc1JlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGZhc3RGb3J3YXJkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjdCA9IHZpZGVvUGxheWVyLnBsYXllck5vZGUuY3VycmVudFRpbWU7XHJcbiAgICAgICAgICAgIHZpZGVvUGxheWVyLnBsYXllck5vZGUuY3VycmVudFRpbWUgPSBjdCArIDI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmYXN0QmFjazogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgY3QgPSB2aWRlb1BsYXllci5wbGF5ZXJOb2RlLmN1cnJlbnRUaW1lO1xyXG4gICAgICAgICAgICB2aWRlb1BsYXllci5wbGF5ZXJOb2RlLmN1cnJlbnRUaW1lID0gY3QgLSAyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25UaW1lVXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjdCA9IHZpZGVvUGxheWVyLnBsYXllck5vZGUuY3VycmVudFRpbWU7XHJcbiAgICAgICAgICAgIHZhciBzZWVrZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Vla2VyLWlucHV0Jyk7XHJcbiAgICAgICAgICAgIHNlZWtlci52YWx1ZSA9IGN0LnRvRml4ZWQoKS50b1N0cmluZygpO1xyXG4gICAgICAgICAgICB2YXIgY3REaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1cnJlbnQtdGltZScpO1xyXG4gICAgICAgICAgICBjdERpc3BsYXkudGV4dENvbnRlbnQgPSBnZXREaXNwbGF5VGltZShjdCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufTtcclxuIl0sIm5hbWVzIjpbImdldERpc3BsYXlUaW1lIiwic2VjIiwiZlRpbWUiLCJjb25maWciLCJtaW5pbXVtSW50ZWdlckRpZ2l0cyIsInVzZUdyb3VwaW5nIiwiaHJzIiwidG9Mb2NhbGVTdHJpbmciLCJtaW5zIiwic2VjcyIsIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJfX2dlbmVyYXRvciIsImJvZHkiLCJmIiwieSIsInQiLCJnIiwiXyIsImxhYmVsIiwic2VudCIsInRyeXMiLCJvcHMiLCJ2ZXJiIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJ0aGlzIiwibiIsInYiLCJvcCIsIlR5cGVFcnJvciIsImNhbGwiLCJwb3AiLCJsZW5ndGgiLCJwdXNoIiwiQ2xhcmVuY2VQbGF5ZXIiLCJvcHRpb25zIiwiZHVyYXRpb24iLCJjdXJyZW50VGltZSIsImxlZnRTZWN0aW9uSUQiLCJyaWdodFNlY3Rpb25JRCIsImNlbnRlclNlY3Rpb25JRCIsInNocmlua2VkIiwibG9vcGVkIiwic3RhdHVzIiwidmlkZW9QbGF5ZXIiLCJub2RlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm5vZGVJRCIsInBsYXllck5vZGUiLCJFcnJvciIsIndpZHRoIiwiaGVpZ2h0IiwibGlzdGVuZXJzIiwicGxheSIsInByZXZlbnREZWZhdWx0IiwicGF1c2VCdG4iLCJjcmVhdGVQbGF5UGF1c2VCdG4iLCJzd2FwUGxheVBhdXNlQnRuIiwicGF1c2UiLCJwbGF5QnRuIiwic3RvcCIsInNlZWsiLCJ0YXJnZXQiLCJwYXJzZUludCIsInRvZ2dsZVJlcGVhdCIsInJwQnRuIiwibG9vcCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsInRvZ2dsZUZ1bGxzY3JlZW4iLCJlbGVtIiwicmVxdWVzdEZ1bGxzY3JlZW4iLCJmYXN0Rm9yd2FyZCIsImN0IiwiZmFzdEJhY2siLCJvblRpbWVVcGRhdGUiLCJ0b0ZpeGVkIiwidG9TdHJpbmciLCJ0ZXh0Q29udGVudCIsInByb3RvdHlwZSIsIm1vdW50Iiwic2V0dGVyIiwiX3RoaXMiLCJfYSIsImJ1aWxkQ29tcG9uZW50cyIsIm9ic2VydmVTaXplIiwic2V0SW50ZXJ2YWwiLCJyZWFkeVN0YXRlIiwic2V0QXR0cmlidXRlIiwiY2xlYXJJbnRlcnZhbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJwbGF5ZXJXcmFwcGVyIiwicGxheWVyTm9kZUNsb25lIiwiY29udHJvbHMiLCJjcmVhdGVFbGVtZW50IiwiY2xvbmVOb2RlIiwic3R5bGUiLCJhcHBlbmRDaGlsZCIsInJlcGxhY2VXaXRoIiwiYnVpbGRDb250cm9scyIsInNlZWtlciIsImNyZWF0ZVNlZWtlciIsImN0cmxCb3giLCJjcmVhdGVWaWRlb0N0cmxCb3giLCJzZWVrZXJEaXYiLCJzZWVrZXJJbnB1dCIsImlkIiwidmlkZW9DdHJsQm94Iiwidm9sdW1lQ3RybCIsImNyZWF0ZVZvbHVtZUN0cmwiLCJwYkNvbnRyb2wiLCJjcmVhdGVQbGF5YmFja0N0cmwiLCJvdGhlckN0cmwiLCJjcmVhdGVPdGhlckJ1dHRvbnMiLCJsZWZ0U2VjdGlvbiIsInNwZWFrZXJJY29uIiwidkljb24iLCJ2U2xpZGVyIiwiY2VudGVyU2VjdGlvbiIsImZiSWNvbiIsImNyZWF0ZUljb24iLCJmYkJ0biIsImNyZWF0ZUJ0biIsImZmSWNvbiIsImZmQnRuIiwidG90YWxUaW1lIiwicmlnaHRTZWN0aW9uIiwic3RvcEJ0biIsInN0b3BJY29uIiwicnBJY29uIiwiZnNCdG4iLCJmc0ljb24iLCJidG5EaXYiLCJidXR0b25UeXBlIiwicGxheUljb24iLCJjb25jYXQiLCJsaXN0ZW5lciIsIm5ld0J1dHRvbiIsIlJlc2l6ZU9ic2VydmVyIiwiZW50cmllcyIsImNvbnRlbnRSZWN0IiwiaGlkZSIsInNob3ciLCJvYnNlcnZlIl0sInNvdXJjZVJvb3QiOiIifQ==